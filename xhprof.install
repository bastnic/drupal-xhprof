<?php
// $Id$

/**
 * Implementation of hook_install().
 */
function xhprof_install() {
  // Use schema API to create database table.
  drupal_install_schema('xhprof');
}

/**
 * Implementation of hook_uninstall().
 */
function xhprof_uninstall() {
  // Use schema API to delete database table.
  drupal_uninstall_schema('xhprof');
  
  // Delete our module's variable from the variables table.
  variable_del('xhprof_foo');
}

/**
 * Implementation of hook_schema().
 */
function xhprof_schema() {
  $schema['xhprof_runs'] = array(
    'description' => t('Stores xhprof runs.'),
    'fields' => array(
      'run_id' => array(
        'type' => 'varchar',
        'length' => 32,
        'not null' => TRUE,
        'default' => '',
        'description' => t('The run ID for this xhprof run.'),
      ),
      'url' => array(
        'type' => 'text',
        'not null' => TRUE,
        'default' => '',
        'description' => t('The url for this run.'),
      ),
      'data' => array(
        'type' => 'text',
        'not null' => TRUE,
        'default' => '',
        'description' => t('The data generated by this xhprof run.')
      ),
      'time' => array(
        'description' => t('Total time taken to execute page.'),
        'type' => 'int',
        'not null' => TRUE,
        'default' => 0
      ),
      'calls' => array(
        'description' => t('Total number of function calls for this xhprof run.'),
        'type' => 'int',
        'not null' => TRUE,
        'default' => 0
      ),
      'memory' => array(
        'description' => t('Change in memory for this xhprof run.'),
        'type' => 'int',
        'not null' => TRUE,
        'default' => 0
      ),
      'cpu' => array(
        'description' => t('CPU usage for this xhprof run.'),
        'type' => 'int',
        'not null' => TRUE,
        'default' => 0
      ),
      'created' => array(
        'description' => t('A Unix timestamp indicating when this run was created.'),
        'type' => 'int',
        'not null' => TRUE,
        'default' => 0
      ),
    ),
    'primary key' => array(
      'run_id'
    ),
  );
  
  return $schema;
}
